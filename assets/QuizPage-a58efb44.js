import{j as e,W as Q,P as _,T as o,a as D,I as P,u as N,b as q,c as A,r as c,R as w,F as u,B as S,d as T}from"./index-4e63139c.js";import{s as k,b as m}from"./index-1238fe9e.js";const B=l=>{const{answerStatus:i=null,children:s,isCorrect:h=!1,onClick:$,prefixNumber:f,selected:a=!1,...p}=l;return e.jsxs(Q,{role:"button",$answerStatus:i,$isCorrect:h,$selected:a,onClick:$,...p,children:[e.jsx(_,{children:f}),e.jsx(o,{$size:"200",$weight:"bold",style:{flex:1},children:s})]})},U=l=>{const{percent:i}=l;if(!(i>=0&&i<=100&&Number.isInteger(i)))throw new Error("0 ~ 100 사이에 숫자만 입력가능합니다.");return e.jsx(D,{role:"progressbar",children:e.jsx(P,{$percent:i})})},H=()=>{const l=N(),i=q(),{quiz:s}=A(t=>t.quiz),h=c.useRef(),[$,f]=c.useState(0),[a,p]=c.useState(0),[d,g]=c.useState(null),[C,b]=c.useState(null),[z,I]=c.useState([]),j=s&&a+1===s.length,r=s&&s[a],x=c.useMemo(()=>r&&k([r.correct_answer,...r.incorrect_answers]),[r]),v=t=>()=>{b(t),x[t]===r.correct_answer?g("correct"):(g("incorrect"),I(n=>[...n,r]))},E=()=>{if(j){const n={incorrectQuizData:z.map(({correct_answer:L,question:R})=>({correct_answer:L,question:R})),quizCount:s.length,seconds:String($)},W=encodeURIComponent(JSON.stringify(n));l({pathname:w.RESULT,search:`?res=${W}`})}else p(t=>t+1),g(null)},y=()=>{confirm("정말로 나가시겠습니까?")&&i(T())};return c.useEffect(()=>(h.current=setInterval(()=>{f(t=>t+1)},1e3),()=>{clearInterval(h.current)}),[]),c.useEffect(()=>{const t=n=>{n.preventDefault(),n.returnValue=""};return window.addEventListener("beforeunload",t),()=>{window.removeEventListener("beforeunload",t)}},[]),c.useEffect(()=>{s||l(w.READY)},[l,s]),s?e.jsxs(u,{$direction:"column",$height:"100%",$gap:20,children:[e.jsxs(u,{$fullWidth:!0,$justifyContent:"space-between",$alignItems:"end",children:[e.jsxs(o,{$size:"600",$weight:"bold",tag:"h2",children:["Question ",a+1]}),e.jsxs(o,{$colorLevel:"600",$size:"75",children:["⏰ ",$,"초"]})]}),e.jsxs(u,{$alignItems:"center",$gap:12,$fullWidth:!0,children:[e.jsx(U,{percent:Math.ceil((a+1)/s.length*100)}),e.jsx(o,{$color:"gray",$colorLevel:"500",$weight:"bold",children:`${a+1}/${s.length}`})]}),e.jsx(o,{$size:"400",$weight:"medium",style:{height:"100px"},children:m(r.question)}),e.jsxs(u,{$height:50,children:[d==="correct"&&e.jsx(o,{id:"correct_text",$color:"success",$colorLevel:"500",children:"정답입니다 😆"}),d==="incorrect"&&e.jsxs(u,{$direction:"column",$gap:8,children:[e.jsx(o,{id:"incorrect_text",$color:"error",$colorLevel:"500",children:"오답입니다 😥"}),e.jsxs(o,{children:["정답은 ",m(r.correct_answer)," 입니다"]})]})]}),e.jsx(u,{id:"answer-list",$direction:"column",$flexGrow:1,$fullWidth:!0,$gap:20,$justifyContent:"center",children:x==null?void 0:x.map((t,n)=>e.jsx(B,{id:"answer-item",answerStatus:d,prefixNumber:n+1,onClick:v(n),isCorrect:(r==null?void 0:r.correct_answer)===t,selected:C===n,children:m(t)},t))}),e.jsxs(u,{$direction:"column",$fullWidth:!0,$justifyContent:"flex-end",$gap:12,style:{minHeight:"108px",...window.innerWidth<480&&{paddingBottom:"12px"}},children:[d&&e.jsx(S,{id:"next-btn",$fullWidth:!0,disabled:!d,onClick:E,children:j?"결과 보기":"다음 문항"}),e.jsx(S,{$color:"gray",$fullWidth:!0,onClick:y,children:"나가기"})]})]}):null};export{H as default};
