import{j as e,W as Q,P as D,T as i,a as P,I as N,u as _,b as q,r as c,R as j,F as u,B as w,c as A}from"./index-8761bca0.js";import{s as T,b as g}from"./index-65217616.js";import{u as k}from"./useDispatch-fdd5cd52.js";const B=l=>{const{answerStatus:o=null,children:s,isCorrect:d=!1,onClick:h,prefixNumber:p,selected:a=!1}=l;return e.jsxs(Q,{role:"button",$answerStatus:o,$isCorrect:d,$selected:a,onClick:h,children:[e.jsx(D,{children:p}),e.jsx(i,{$size:"200",$weight:"bold",style:{flex:1},children:s})]})},U=l=>{const{percent:o}=l;if(!(o>=0&&o<=100&&Number.isInteger(o)))throw new Error("0 ~ 100 사이에 숫자만 입력가능합니다.");return e.jsx(P,{role:"progressbar",children:e.jsx(N,{$percent:o})})},G=()=>{const l=_(),o=k(),{quiz:s}=q(t=>t.quiz),d=c.useRef(),[h,p]=c.useState(0),[a,S]=c.useState(0),[$,x]=c.useState(null),[C,b]=c.useState(null),[z,I]=c.useState([]),m=s&&a+1===s.length,r=s&&s[a],f=c.useMemo(()=>r&&T([r.correct_answer,...r.incorrect_answers]),[r]),v=t=>()=>{b(t),f[t]===r.correct_answer?x("correct"):(x("incorrect"),I(n=>[...n,r]))},E=()=>{if(m){const n={incorrectQuizData:z.map(({correct_answer:L,question:R})=>({correct_answer:L,question:R})),quizCount:s.length,seconds:String(h)},y=encodeURIComponent(JSON.stringify(n));l({pathname:j.RESULT,search:`?res=${y}`})}else S(t=>t+1),x(null)},W=()=>{confirm("정말로 나가시겠습니까?")&&o(A())};return c.useEffect(()=>(d.current=setInterval(()=>{p(t=>t+1)},1e3),()=>{clearInterval(d.current)}),[]),c.useEffect(()=>{const t=n=>{n.preventDefault(),n.returnValue=""};return window.addEventListener("beforeunload",t),()=>{window.removeEventListener("beforeunload",t)}},[]),c.useEffect(()=>{s||l(j.READY)},[l,s]),s?e.jsxs(u,{$direction:"column",$height:"100%",$gap:20,children:[e.jsxs(u,{$fullWidth:!0,$justifyContent:"space-between",$alignItems:"end",children:[e.jsxs(i,{$size:"600",$weight:"bold",tag:"h2",children:["Question ",a+1]}),e.jsxs(i,{$colorLevel:"600",$size:"75",children:["⏰ ",h,"초"]})]}),e.jsxs(u,{$alignItems:"center",$gap:12,$fullWidth:!0,children:[e.jsx(U,{percent:(a+1)/s.length*100}),e.jsx(i,{$color:"gray",$colorLevel:"500",$weight:"bold",children:`${a+1}/${s.length}`})]}),e.jsx(i,{$size:"400",$weight:"medium",style:{height:"100px"},children:g(r.question)}),e.jsxs(u,{$height:50,children:[$==="correct"&&e.jsx(i,{$color:"success",$colorLevel:"500",children:"정답입니다 😆"}),$==="incorrect"&&e.jsxs(u,{$direction:"column",$gap:8,children:[e.jsx(i,{$color:"error",$colorLevel:"500",children:"오답입니다 😥"}),e.jsxs(i,{children:["정답은 ",g(r.correct_answer)," 입니다"]})]})]}),e.jsx(u,{$direction:"column",$flexGrow:1,$fullWidth:!0,$gap:20,$justifyContent:"center",children:f==null?void 0:f.map((t,n)=>e.jsx(B,{answerStatus:$,prefixNumber:n+1,onClick:v(n),isCorrect:(r==null?void 0:r.correct_answer)===t,selected:C===n,children:g(t)},t))}),e.jsxs(u,{$direction:"column",$fullWidth:!0,$gap:12,style:{...window.innerWidth<480&&{paddingBottom:"12px"}},children:[e.jsx(w,{$fullWidth:!0,disabled:!$,onClick:E,children:m?"결과 보기":"다음 문항"}),e.jsx(w,{$color:"gray",$fullWidth:!0,onClick:W,children:"나가기"})]})]}):null};export{G as default};
